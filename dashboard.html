<!-- Dashboard Content -->
<!-- SEZIONE RICERCA RAPIDA ASSISTITO -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card shadow-sm border-primary">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="bi bi-search"></i> Ricerca Rapida Assistito</h5>
            </div>
            <div class="card-body">
                <form id="formRicercaRapida" class="row g-3 align-items-end">
                    <div class="col-md-10">
                        <label for="quickSearchInput" class="form-label">Cerca per Nome, Cognome o Codice Fiscale</label>
                        <input type="text" 
                               class="form-control form-control-lg" 
                               id="quickSearchInput" 
                               placeholder="Es: Mario Rossi, RSSMRA80A01H501U, Bianchi..."
                               autocomplete="off">
                        <small class="text-muted">
                            <i class="bi bi-info-circle"></i> La ricerca cerca in OR su Nome, Cognome e CF
                        </small>
                    </div>
                    <div class="col-md-2">
                        <button type="submit" class="btn btn-primary btn-lg w-100">
                            <i class="bi bi-search"></i> Cerca
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <!-- COLONNA SINISTRA: Evidenze / Promemoria -->
    <div class="col-lg-7">
        <div class="card shadow-sm">
            <div class="card-header bg-white">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <h5 class="mb-0">
                        <i class="bi bi-exclamation-triangle text-warning"></i> Evidenze / Promemoria
                    </h5>
                </div>
                <div class="d-flex gap-2">
                    <div class="btn-group" role="group">
                        <button class="btn btn-sm btn-outline-primary active" id="btnEvidenzeTabella">
                            <i class="bi bi-table"></i> Tabella
                        </button>
                        <button class="btn btn-sm btn-outline-primary" id="btnEvidenzeCard">
                            <i class="bi bi-grid-3x3"></i> Card
                        </button>
                    </div>
                    <button class="btn btn-sm btn-outline-success" id="exportEvidenze">
                        <i class="bi bi-file-earmark-excel"></i> Esporta
                    </button>
                    <button class="btn btn-sm btn-primary" id="btnNuovaEvidenza">
                        <i class="bi bi-plus-circle"></i> Nuova Evidenza
                    </button>
                </div>
            </div>
            <div class="card-body">
                <!-- Filtri -->
                <div class="row mb-3">
                    <div class="col-md-6">
                        <input type="text" class="form-control" id="searchEvidenze" 
                               placeholder="Cerca per nome/CF assistito...">
                    </div>
                    <div class="col-md-3">
                        <select class="form-select" id="categoriaFilter">
                            <option value="">Tutte le categorie</option>
                            <option value="1">Permessi e Controlli</option>
                            <option value="2">Trasferimenti</option>
                            <option value="3">Stati Domanda</option>
                            <option value="4">Stati Prestazione</option>
                            <option value="5">Recuperi</option>
                            <option value="6">Ricorsi</option>
                            <option value="7">Verbali</option>
                            <option value="8">ASDAA</option>
                            <option value="9">Modifiche</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <select class="form-select" id="tipoEvidenzaFilter">
                            <option value="">Tipo evidenza...</option>
                        </select>
                    </div>
                </div>

                <!-- Tabs -->
                <ul class="nav nav-tabs mb-3" id="evidenzeTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="scadute-tab" data-bs-toggle="tab" 
                                data-bs-target="#scadute" type="button" role="tab">
                            <i class="bi bi-exclamation-circle text-danger"></i> 
                            Scadute <span class="badge bg-danger" id="badgeScadute">0</span>
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="correnti-tab" data-bs-toggle="tab" 
                                data-bs-target="#correnti" type="button" role="tab">
                            <i class="bi bi-clock text-warning"></i> 
                            Correnti <span class="badge bg-warning" id="badgeCorrenti">0</span>
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="future-tab" data-bs-toggle="tab" 
                                data-bs-target="#future" type="button" role="tab">
                            <i class="bi bi-calendar-check text-success"></i> 
                            Future <span class="badge bg-success" id="badgeFuture">0</span>
                        </button>
                    </li>
                </ul>

                <!-- Tab Content -->
                <div class="tab-content" id="evidenzeTabContent">
                    <div class="tab-pane fade show active" id="scadute" role="tabpanel">
                        <div id="evidenzeScaduteContainer" class="evidenze-container">
                            <div class="text-center text-muted py-5">
                                <div class="spinner-border" role="status">
                                    <span class="visually-hidden">Caricamento...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="correnti" role="tabpanel">
                        <div id="evidenzeCorrentiContainer" class="evidenze-container">
                            <div class="text-center text-muted py-5">
                                <i class="bi bi-inbox display-4"></i>
                                <p class="mt-3">Caricamento evidenze correnti...</p>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="future" role="tabpanel">
                        <div id="evidenzeFutureContainer" class="evidenze-container">
                            <div class="text-center text-muted py-5">
                                <i class="bi bi-inbox display-4"></i>
                                <p class="mt-3">Caricamento evidenze future...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- COLONNA DESTRA: Note -->
    <div class="col-lg-5">
        <div class="card shadow-sm">
            <div class="card-header bg-white">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <h5 class="mb-0">
                        <i class="bi bi-sticky text-info"></i> Note
                    </h5>
                </div>
                <div class="d-flex gap-2">
                    <div class="btn-group" role="group">
                        <button class="btn btn-sm btn-outline-primary active" id="btnNoteTabella">
                            <i class="bi bi-table"></i> Tabella
                        </button>
                        <button class="btn btn-sm btn-outline-primary" id="btnNoteCard">
                            <i class="bi bi-grid-3x3"></i> Card
                        </button>
                    </div>
                    <button class="btn btn-sm btn-outline-success" id="exportNote">
                        <i class="bi bi-file-earmark-excel"></i> Esporta
                    </button>
                    <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#modalNuovaNota">
                        <i class="bi bi-plus-circle"></i> Nuova Nota
                    </button>
                </div>
            </div>
            <div class="card-body">
                <!-- Filtro Categoria Note -->
                <div class="mb-3">
                    <select class="form-select" id="categoriaNotaFilter">
                        <option value="">Tutte le categorie</option>
                        <option value="residenza">Residenza</option>
                        <option value="pagamenti">Pagamenti</option>
                        <option value="degenze">Degenze</option>
                        <option value="amministrazione">Amministrazione Sostegno</option>
                        <option value="redditi">Redditi</option>
                        <option value="varie">Varie</option>
                    </select>
                </div>

                <!-- Container Note -->
                <div id="noteContainer" style="max-height: 700px; overflow-y: auto;">
                    <div class="text-center text-muted py-5">
                        <div class="spinner-border" role="output">
                            <span class="visually-hidden">Caricamento...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- SEZIONE VERBALI SABES/ASDAA -->
<div class="row mt-4">
    <div class="col-7">
        <div class="card shadow-sm">
            <div class="card-header bg-white d-flex justify-content-between align-items-center">
                <h5 class="mb-0">
                    <i class="bi bi-file-earmark-medical text-primary"></i> Nuovi Verbali SABES/ASDAA
                </h5>
                <div>
                    <button class="btn btn-sm btn-outline-success" id="exportVerbali">
                        <i class="bi bi-file-earmark-excel"></i> Esporta
                    </button>
                </div>
            </div>
            <div class="card-body">
                <!-- Filtro e ricerca -->
                <div class="row mb-3">
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="searchVerbali" 
                               placeholder="Cerca per CF, protocollo...">
                    </div>
                    <div class="col-md-3">
                        <select class="form-select" id="invaliditaFilter">
                            <option value="">Tutte le percentuali</option>
                            <option value="0-33">0-33%</option>
                            <option value="34-66">34-66%</option>
                            <option value="67-99">67-99%</option>
                            <option value="100">100%</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <select class="form-select" id="statoVerbaleFilter">
                            <option value="">Tutti gli stati</option>
                            <option value="da_valutare">Da valutare</option>
                            <option value="ricevibile">Ricevibile</option>
                            <option value="irricevibile">Irricevibile</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <button class="btn btn-primary w-100" id="btnAggiornaMVerbali">
                            <i class="bi bi-arrow-clockwise"></i> Aggiorna
                        </button>
                    </div>
                </div>

                <!-- Tabella verbali -->
                <div class="table-responsive" style="max-height: 600px; overflow-y: auto;">
                    <table class="table table-hover table-sm">
                        <thead class="table-light sticky-top">
                            <tr>
                                <th>Codice Fiscale</th>
                                <th>Cognome</th>
                                <th>Nome</th>
                                <th>Data Nascita</th>
                                <th>Invalidit√† Civile</th>
                                <th>Cecit√†</th>
                                <th>Sordit√†</th>
                            </tr>
                        </thead>
                        <tbody id="verbaliTableBody">
                            <tr>
                                <td colspan="9" class="text-center text-muted py-5">
                                    <div class="spinner-border" role="status" id="verbaliSpinner">
                                        <span class="visually-hidden">Caricamento...</span>
                                    </div>
                                    <p class="mt-3">Caricamento verbali...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Paginazione -->
                <div class="d-flex justify-content-between align-items-center mt-3">
                    <div class="text-muted">
                        <small>Totale: <span id="totaleVerbali">0</span> verbali</small>
                    </div>
                    <nav>
                        <ul class="pagination pagination-sm mb-0" id="paginationVerbali">
                            <!-- Paginazione dinamica -->
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal Nuova Evidenza -->
<div class="modal fade" id="modalNuovaEvidenza" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="bi bi-exclamation-triangle"></i> Nuova Evidenza
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="formNuovaEvidenza">
                    <div class="mb-3">
                        <label for="evidenzaCategoria" class="form-label">Categoria</label>
                        <select class="form-select" id="evidenzaCategoria" required>
                            <option value="">Seleziona categoria...</option>
                            <option value="1">Permessi e Controlli</option>
                            <option value="2">Trasferimenti</option>
                            <option value="3">Stati Domanda</option>
                            <option value="4">Stati Prestazione</option>
                            <option value="5">Recuperi</option>
                            <option value="6">Ricorsi</option>
                            <option value="7">Verbali</option>
                            <option value="8">ASDAA</option>
                            <option value="9">Modifiche</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="evidenzaTipo" class="form-label">Tipo Evidenza</label>
                        <select class="form-select" id="evidenzaTipo" required>
                            <option value="">Seleziona tipo...</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="evidenzaCF" class="form-label">Codice Fiscale Assistito</label>
                        <input type="text" class="form-control" id="evidenzaCF" 
                               placeholder="RSSMRA80A01H501X" required>
                    </div>
                    <div class="mb-3">
                        <label for="evidenzaScadenza" class="form-label">Data Scadenza</label>
                        <input type="date" class="form-control" id="evidenzaScadenza" required>
                    </div>
                    <div class="mb-3">
                        <label for="evidenzaDescrizione" class="form-label">Descrizione</label>
                        <textarea class="form-control" id="evidenzaDescrizione" rows="3" 
                                  placeholder="Inserisci la descrizione..." required></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                <button type="button" class="btn btn-primary" id="btnSalvaEvidenza">
                    <i class="bi bi-save"></i> Salva Evidenza
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Nuova Nota -->
<div class="modal fade" id="modalNuovaNota" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="bi bi-sticky"></i> Nuova Nota
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="formNuovaNota">
                    <div class="mb-3">
                        <label for="notaCategoria" class="form-label">Categoria</label>
                        <select class="form-select" id="notaCategoria" required>
                            <option value="">Seleziona categoria...</option>
                            <option value="Residenza">üè† Residenza</option>
                            <option value="Pagamenti">üí∞ Pagamenti</option>
                            <option value="Degenze">üè• Degenze</option>
                            <option value="Amministrazione Sostegno">‚öñÔ∏è Amministrazione Sostegno</option>
                            <option value="Redditi">üíµ Redditi</option>
                            <option value="Varie">üìù Varie</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="notaCF" class="form-label">Codice Fiscale Assistito</label>
                        <input type="text" class="form-control" id="notaCF" 
                               placeholder="RSSMRA80A01H501X" required>
                    </div>
                    <div class="mb-3">
                        <label for="notaTesto" class="form-label">Testo Nota</label>
                        <textarea class="form-control" id="notaTesto" rows="4" 
                                  placeholder="Inserisci il testo della nota..." required></textarea>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="notaPrincipale">
                        <label class="form-check-label" for="notaPrincipale">
                            <i class="bi bi-star-fill text-warning"></i> Contrassegna come Nota Principale
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                <button type="button" class="btn btn-primary" id="btnSalvaNota">
                    <i class="bi bi-save"></i> Salva Nota
                </button>
            </div>
        </div>
    </div>
</div>
